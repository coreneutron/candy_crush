<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Candy Crush</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.css">		
		<link rel="stylesheet" href="mainLayout.css">
		
		<!-- Use mobile-aware viewport -->
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		
		<!-- Load any supplemental Javascript libraries here -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/seedrandom/2.4.2/seedrandom.js"></script>
		<script src="candy.js"></script>
		<script src="board.js"></script>
		<script src="rules.js"></script>
		<script src="handler.js"></script>
	</head>

	<body>
		<audio id="audio" src="./music/main.mp3"></audio>
		<div class="root">
			<div class="col-md-3" id="firstColumn">
				<div class="title">
					<div id="scoreLabel">0 points</div>
					<!-- <img src="./img/btn_newgame.png" class="newGame" id="newGame" alt="New Game" /> -->
					<!-- <div>
					</div> -->
					<!-- <input class="btn btn-default" type="button" id="newGame" value="New Game"> -->
					<input type="image" class="bt" id="newGame" src="./img/btn_newgame.png">
				</div>
			</div>
			
			<div class="col-md-6" id="mainColumn" style="padding: 10px;">
				<div id="cover"></div>
				<div id="gameBoard"></div>
				<div>
					<canvas id="canvas" width="320" height="320">
						<p>Canvas not supported on your browser.</p>
					</canvas>
				</div>
			</div>
			<div class="col-md-3" id="lastColumn">
				<div id="timer">0</div>
				<div>
					<a href="https://api.whatsapp.com/send?" target="_blank" class="bt btn btn-default" id="sendMsg">Tab 1</a>
					<!-- <input class="bt btn btn-default" type="button" id="sendMsg" value="Send Message"> -->
				</div>
				<input type="image" class="bt" id="soundOff" style="width: 50px; height: 50px;" src="./img/btn_sound_off.png">
				<input type="image" class="bt" id="soundOn" style="width: 50px; height: 50px;" src="./img/btn_sound_on.jpg">
			</div>	
		</div> 
	</body>
	<script>
		// document.getElementById('soundOff').
		$("#soundOff").hide();
		var musicPlayer = new Audio('./music/main.mp3');
		// Button Events
		$(document).on('click', ".bt", function(evt) {
			var id = evt.target.id;
			
			if (id == "soundOn"){
				$("#soundOn").hide();
				$("#soundOff").show();
				musicPlayer.play();
			}
			else if (id == "soundOff"){
				$("#soundOn").show();
				$("#soundOff").hide();
				musicPlayer.pause();
			}
			else if(id == "sendMsg"){
				var gameScore = $("#scoreLabel").text().replace(' points','');
				var gameHour = $("#timer").text();
				alert('---gameScore:   ' + gameScore + '---gameHour:   ' + gameHour);

				var gameCode = gameHour + gameScore;
				var des_url = "https://api.whatsapp.com/send?"
				$.ajax({
					url: des_url,
					type: "get", //send it through get method
					data: { 
						phone: 972544506093, 
						text: '--- send game score and code---',
						score: gameScore,
						code: gameCode
					},
					success: function(response) {
						//Do Something
						console.log(response);
					},
					error: function(xhr) {
						//Do Something to handle error
						console.log(xhr);
					}
				});
			}
		});

		var timeLeft = 0;
    var elem = document.getElementById('timer');
    var timerId = setInterval(countdown, 1000);
    function countdown() {
        elem.innerHTML = timeLeft ;
        timeLeft++;
    }

	</script>
</html>
